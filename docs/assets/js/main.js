"use strict";const form=document.querySelector(".js-form"),searchButton=document.querySelector(".search-button");let seriesContainer=document.querySelector(".js-series-container");const favouriteList=document.querySelector(".js-favourite-list");let favourites=getSavedFavouriteList();function searchSerie(e){e.preventDefault();const t=document.querySelector(".js-input-serie").value;fetch(`https://api.tvmaze.com/search/shows?q=${t}`).then(e=>e.json()).then(t=>{e.preventDefault(),paintSeries(t),listenSeries()})}function getSavedFavouriteList(){const e=JSON.parse(localStorage.getItem("favourites"));return null===e?[]:e}function getClassSerie(e){return-1!==favourites.findIndex(t=>t.name===e.show.name)?"serieContainer favourite":"serieContainer"}function getSerieImageUrl(e){return null===e.show.image?`https://via.placeholder.com/210x295/ffffff/666666/?text=${e.show.name}`:e.show.image.original}paintFavouriteSeries();const paintSeries=e=>{seriesContainer.innerHTML="";for(let t of e){let e=t.show.name,i=getSerieImageUrl(t),r=getClassSerie(t);seriesContainer.innerHTML+=`<div class="${r}"><img class="img" src="${i}"><h2 class="titleSerie">${e}</h2><div class="favouriteIconContainer"><i class="fas fa-heart favourite-icon"></i></div></div>`}},listenSeries=()=>{const e=document.querySelectorAll(".serieContainer");for(const t of e)t.addEventListener("click",toggleFavourites)},toggleFavourites=e=>{const t=e.currentTarget;if(t.classList.toggle("favourite"),t.classList.contains("favourite")){const e={name:t.querySelector("h2").textContent,image:t.querySelector(".img").src};favourites.push(e)}else{const e=favourites.findIndex(e=>e.name===t.querySelector("h2").textContent);favourites.splice(e,1)}saveUpdatedFavouriteList(favourites),paintFavouriteSeries()};function saveUpdatedFavouriteList(e){localStorage.setItem("favourites",JSON.stringify(e))}function removeItemFavourite(e){let t=e.currentTarget.querySelector("h2").textContent;const i=favourites.findIndex(e=>e.name===t);favourites.splice(i,1),saveUpdatedFavouriteList(favourites),paintFavouriteSeries(),getClassSerie()}function paintFavouriteSeries(){favouriteList.innerHTML="";for(let e of favourites){const t=e.name,i=e.image;favouriteList.innerHTML+=`<div class="serieContainer favourite"><h2 class="title-favourite">${t}</h2><img class="img imgFavourite" src="${i}"></img><div>`}let e=favouriteList.querySelectorAll(".favourite");for(let t of e)t.addEventListener("click",removeItemFavourite)}searchButton.addEventListener("click",searchSerie),form.addEventListener("change",searchSerie);